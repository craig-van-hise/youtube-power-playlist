nimum like 50px).

### ðŸ›‘ The "Iframe Shield" Fix Prompt


We need to fix the Resize Logic completely. The current implementation is failing because the YouTube Iframe is "stealing" mouse events (causing the Sticky Mouse bug) and the panels are transparent (causing bleed-through).

Please **REPLACE** the entire `makeResizable` function and the CSS for the panels in `src/publishing/template/index.html.j2` with this robust version.

**1. CSS: Force Opacity & Add the "Safety Shield"**
   Add this to the `<style>` block:
   ```css
   /* Force Solid Backgrounds to stop bleed-through */
   #left-panel, #player-panel, #video-stage, #player-controls {
       background-color: #101922 !important; 
       position: relative;
       z-index: 10;
   }
   
   /* The "Safety Shield" - Invisible by default */
   #iframe-shield {
       position: absolute;
       top: 0;
       left: 0;
       width: 100%;
       height: 100%;
       z-index: 9999; /* Super high to catch all clicks */
       display: none; /* Hidden normally */
   }
   
   /* Splitters */
   #splitter-vertical {
       width: 12px;
       background: #0d1218;
       border-left: 1px solid #233648;
       cursor: col-resize;
       flex-shrink: 0;
   }
   #splitter-horizontal {
       height: 12px;
       background: #0d1218;
       border-top: 1px solid #233648;
       cursor: row-resize;
       flex-shrink: 0;
   }

```

**2. HTML: Add the Shield Element**
Inside the `#video-stage` div, add the shield right next to the player div:

```html
<div id="video-stage">
    <div id="yt-player"></div>
    <div id="iframe-shield"></div> </div>

```

**3. JavaScript: The Robust Drag Logic**
Replace the old `makeResizable` function with this:

```javascript
function makeResizable() {
    const leftPanel = document.getElementById('left-panel');
    const videoStage = document.getElementById('video-stage');
    const vSplitter = document.getElementById('splitter-vertical');
    const hSplitter = document.getElementById('splitter-horizontal');
    const shield = document.getElementById('iframe-shield'); // The fix

    // Helper to Start Drag
    function startDrag() {
        shield.style.display = 'block'; // ACTIVATE SHIELD
        document.body.style.userSelect = 'none'; // Stop text selection
    }

    // Helper to Stop Drag
    function stopDrag() {
        shield.style.display = 'none'; // DEACTIVATE SHIELD
        document.body.style.userSelect = 'auto';
        document.body.style.cursor = 'default';
    }

    // --- Vertical Resize (Sidebar) ---
    if (vSplitter) {
        vSplitter.onmousedown = function(e) {
            e.preventDefault();
            startDrag();
            document.body.style.cursor = 'col-resize';
            
            function onMouseMove(moveEvent) {
                // Remove upper limit. Only min-width safety of 50px.
                let newWidth = moveEvent.clientX;
                if (newWidth < 50) newWidth = 50; 
                
                leftPanel.style.width = newWidth + 'px';
                localStorage.setItem('layout_sidebar_width', newWidth);
            }
            
            function onMouseUp() {
                stopDrag();
                window.removeEventListener('mousemove', onMouseMove);
                window.removeEventListener('mouseup', onMouseUp);
            }

            window.addEventListener('mousemove', onMouseMove);
            window.addEventListener('mouseup', onMouseUp);
        };
    }

    // --- Horizontal Resize (Video Height) ---
    if (hSplitter) {
        hSplitter.onmousedown = function(e) {
            e.preventDefault();
            startDrag();
            document.body.style.cursor = 'row-resize';
            
            const startY = e.clientY;
            const startHeight = videoStage.getBoundingClientRect().height;

            function onMouseMove(moveEvent) {
                const delta = moveEvent.clientY - startY;
                let newHeight = startHeight + delta;
                
                // Remove upper limit. Only min-height safety of 50px.
                if (newHeight < 50) newHeight = 50;

                videoStage.style.height = newHeight + 'px';
            }

            function onMouseUp() {
                stopDrag();
                window.removeEventListener('mousemove', onMouseMove);
                window.removeEventListener('mouseup', onMouseUp);
            }

            window.addEventListener('mousemove', onMouseMove);
            window.addEventListener('mouseup', onMouseUp);
        };
    }
}

This is the "Iframe Trap," and it explains every erratic behavior you are seeing.

**The "Sticky Mouse" Problem:** When you drag your mouse fast, the cursor moves *over* the YouTube video (which is an iframe). The moment your mouse enters that iframe, the browser **stops sending mouse events** to your resize script. Your script never hears "Mouse Up," so it thinks you are still dragging forever.

**The Fix:** We need to create a transparent "Safety Shield" (overlay) that covers the video *only while you are dragging*. This prevents the video from stealing your mouse clicks.

**The Transparency Problem:** The layout is likely using `transparent` backgrounds by default. We will force solid colors on the panels to stop the bleed-through.

**The Size Lock:** We will remove the `50%` or `70%` clamp and just let you resize freely (with a tiny safety minimum like 50px).

### ðŸ›‘ The "Iframe Shield" Fix Prompt

**Copy and paste this into your Antigravity chat:**

```markdown
We need to fix the Resize Logic completely. The current implementation is failing because the YouTube Iframe is "stealing" mouse events (causing the Sticky Mouse bug) and the panels are transparent (causing bleed-through).

Please **REPLACE** the entire `makeResizable` function and the CSS for the panels in `src/publishing/template/index.html.j2` with this robust version.

**1. CSS: Force Opacity & Add the "Safety Shield"**
   Add this to the `<style>` block:
   ```css
   /* Force Solid Backgrounds to stop bleed-through */
   #left-panel, #player-panel, #video-stage, #player-controls {
       background-color: #101922 !important; 
       position: relative;
       z-index: 10;
   }
   
   /* The "Safety Shield" - Invisible by default */
   #iframe-shield {
       position: absolute;
       top: 0;
       left: 0;
       width: 100%;
       height: 100%;
       z-index: 9999; /* Super high to catch all clicks */
       display: none; /* Hidden normally */
   }
   
   /* Splitters */
   #splitter-vertical {
       width: 12px;
       background: #0d1218;
       border-left: 1px solid #233648;
       cursor: col-resize;
       flex-shrink: 0;
   }
   #splitter-horizontal {
       height: 12px;
       background: #0d1218;
       border-top: 1px solid #233648;
       cursor: row-resize;
       flex-shrink: 0;
   }

```

**2. HTML: Add the Shield Element**
Inside the `#video-stage` div, add the shield right next to the player div:

```html
<div id="video-stage">
    <div id="yt-player"></div>
    <div id="iframe-shield"></div> </div>

```

**3. JavaScript: The Robust Drag Logic**
Replace the old `makeResizable` function with this:

```javascript
function makeResizable() {
    const leftPanel = document.getElementById('left-panel');
    const videoStage = document.getElementById('video-stage');
    const vSplitter = document.getElementById('splitter-vertical');
    const hSplitter = document.getElementById('splitter-horizontal');
    const shield = document.getElementById('iframe-shield'); // The fix

    // Helper to Start Drag
    function startDrag() {
        shield.style.display = 'block'; // ACTIVATE SHIELD
        document.body.style.userSelect = 'none'; // Stop text selection
    }

    // Helper to Stop Drag
    function stopDrag() {
        shield.style.display = 'none'; // DEACTIVATE SHIELD
        document.body.style.userSelect = 'auto';
        document.body.style.cursor = 'default';
    }

    // --- Vertical Resize (Sidebar) ---
    if (vSplitter) {
        vSplitter.onmousedown = function(e) {
            e.preventDefault();
            startDrag();
            document.body.style.cursor = 'col-resize';
            
            function onMouseMove(moveEvent) {
                // Remove upper limit. Only min-width safety of 50px.
                let newWidth = moveEvent.clientX;
                if (newWidth < 50) newWidth = 50; 
                
                leftPanel.style.width = newWidth + 'px';
                localStorage.setItem('layout_sidebar_width', newWidth);
            }
            
            function onMouseUp() {
                stopDrag();
                window.removeEventListener('mousemove', onMouseMove);
                window.removeEventListener('mouseup', onMouseUp);
            }

            window.addEventListener('mousemove', onMouseMove);
            window.addEventListener('mouseup', onMouseUp);
        };
    }

    // --- Horizontal Resize (Video Height) ---
    if (hSplitter) {
        hSplitter.onmousedown = function(e) {
            e.preventDefault();
            startDrag();
            document.body.style.cursor = 'row-resize';
            
            const startY = e.clientY;
            const startHeight = videoStage.getBoundingClientRect().height;

            function onMouseMove(moveEvent) {
                const delta = moveEvent.clientY - startY;
                let newHeight = startHeight + delta;
                
                // Remove upper limit. Only min-height safety of 50px.
                if (newHeight < 50) newHeight = 50;

                videoStage.style.height = newHeight + 'px';
            }

            function onMouseUp() {
                stopDrag();
                window.removeEventListener('mousemove', onMouseMove);
                window.removeEventListener('mouseup', onMouseUp);
            }

            window.addEventListener('mousemove', onMouseMove);
            window.addEventListener('mouseup', onMouseUp);
        };
    }
}

```

```

### ðŸ Final Test
1.  **Generate & Refresh.**
2.  **Test the Drag:** Grab the sidebar splitter. Whip your mouse fast across the screen. Does it let go when you release? (The shield ensures it will).
3.  **Test the Size:** Drag the video really small or huge. (Limits are removed).
4.  **Test Transparency:** Is the "bleed-through" gone? (The `#101922` background fixes this).

This "Shield" technique is standard practice for dragging around iframes. It should solve the erratic behavior instantly.

```

